Generic instructions
~~~~~~~~~~~~~~~~~~~~
Check config.mk and/or config.h for build-time setup.
Specifically, check INITCTL, INITTAB, LOGDIR in config.h,
compiler setup and installation directories in config.mk.

Run make, then make install.

Alternatively, run mostly-autotools-compatible configure.

Use initblocks variable to choose which modules to build.
See comments in config.mk.

To try it on a system with another init installed, run

	configure --with-s

You will get sinit, stelinit and /etc/sinittab.


Which libc to use
~~~~~~~~~~~~~~~~~
In most cases sninit should be built with dietlibc.

sninit does not need dynamic libc, and will not benefit from using one.
The smallest sninit executable is the one linked statically against dietlibc.

sninit also does not need anything other than basic syscalls and a handful
of bog-standard string manipulation function from libc.
It will not benefit from using anything fancier than dietlibc.

Settings for other libc-s are only provided for completeness,
for testing, and for unusual cases not considered here.


Building with bundled libc
~~~~~~~~~~~~~~~~~~~~~~~~~~
sninit comes with a stripped-down, minimalistic subset of dietlibc
capable just enough to fit sninit demands.
Sample usage (cross-build for x86 on x86_64):

	ARCH = x86
	CC = gcc -m32 -march=i686

CC will be called with -nostdinc -nostdlib so it does not matter
which libc, if any, it has in its sysroot.

Only x86 and x86_64 architectures are supported at this moment.
For any other targets, fall back to the original dietlibc.

Using bundled libc provides little benefit over properly configured
dietlibc in terms of code size (because it is dietlibc code,
if perhaps re-written in some places) but provides clear,
uncluttered libc code for debugging.


Building with dietlibc
~~~~~~~~~~~~~~~~~~~~~~
Recommended settings:
	CC = diet gcc
or
	CC = diet clang

Dietlibc up to and including 0.33 does not provide ppoll(2) system call.
Either use sys_ppoll.c (indirect syscall, via syscall(2)), or patch dietlibc.
Note syscall(2) is in libcompat.a, so you'll need
	LIBS = -lcompat

Because dietlibc implies static linkage and small executable size, consider using
sys_printf.c and sys_strerror.c. See comments in those files.
Size optimization (-Os) helps in most cases.
Link-time optimization (-flto) may or may not help, check for yourself.


Building with musl
~~~~~~~~~~~~~~~~~~
Use CC = musl-gcc; no other settings should be necessary.

If musl-gcc complains about linux/*.h, you probably have no linux headers in musl-gcc path.
Symlink /usr/include/linux and /usr/include/asm to resp. $MUSL/include/linux
and $MUSL/include/asm.


Building with glibc
~~~~~~~~~~~~~~~~~~~
glibc does not provide getdents(2), even thought it is a linux system call.
Use sys_getdents.c instead.
